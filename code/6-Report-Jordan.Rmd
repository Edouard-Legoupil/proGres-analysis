---
title: "Statistical Analysis of Refugee Profiles: Jordan"
author: "UNHCR MENA Regional Protection Services - Edouard legoupil, Snr Information Management Officer"
date: "2 February 2016"
output:
  pdf_document:
    fig_caption: yes
    number_sections: yes
    toc: yes
---


Many reports are already produced from proGres but they mostly look at univariate analysis, i.e esch variable within the dataset is displayed one by one. The present document is an attempt to explore various dimensions interact between each others.

This analysis covers information aggregated at the refugee refugee household level and is based on the information that is consolidated in the regional datawarehouse.



```{r , echo=FALSE, warning=FALSE, message=FALSE}

# , cache=TRUE
#getwd("D:/R-project/proGres-analysis")
## Load the pre-processed dataset (cf "code/1-recode-data.R"")
data <- read.csv("D:/R-project/proGres-analysis/data/progrescase2.csv")
data <-data[data$CountryAsylum == "JOR", ]
## load all packages
source("D:/R-project/proGres-analysis/code/0-packages.R")

```

# Excecutive Summary

*


# Presentation of the dataset

The information recorded in the Refugee Registration Database covers not only basic demographic characteristics but also identification of Specific Needs and recording of Events such as Ressettlement Acceptation or Voluntary Departure.

## Household Information

Variable          | Description
------------------|---------------------------------------
Num_Inds          | Number of Individual in the household
Case.size         | Size of the household - Discretisation & recategorisation of the *Num_Inds* variable
Child_0_14        | Number of Child under 14 in the household
Youth_15_17       | t
Work_15_64        | t
Eldern_65         | t
dependency        | t
youthdependency   | t
elederndependency | t
Male              | t
Female            | t
female.ratio      | t
dem_age           | t
agecohort         | t
AVG_Age           | t
AVGAgecohort      | t
STDEV_Age         | t
STDEVAgeclass     | t


## Information related to the head of household

Variable          | Description
------------------|---------------------------------------
dem_sex           | t
dem_marriage      | t
dem_marriagecat   | t
dem_birth_country | t
occupation        | t
occupationcat     | t
edu_highest       | t
edu_highestcat    | t

## Geographic Information

Variable                 | Description
-------------------------|---------------------------------------
CountryOrigin            | t
CountryOriginCategory    | t
cool1                    | t
CountryAsylum            | t
coal1                    | t

## Chronologic Information

Variable             | Description
---------------------|---------------------------------------
YearArrival          | t
YearArrivalCategory  | t
Montharrival         | t
season               | t

## Specific need within household

Variable                                    | Description
--------------------------------------------|---------------------------------------
Child.at.risk                               | t
Disability                                  | t
Family.unity                                | t
Older.person.at.risk                        | t
Pregnant.or.lactating                       | t
Serious.medical.condition                   | t
SGBV                                        | t
Single.parent                               | t
Specific.legal.physical.protection.needs    | t
Torture                                     | t
Unaccompanied.or.separated.child            | t
Woman.at.risk                               | t

## Reason for voluntary return if any

 
* Departed.to.3rd.country 
* Returned.to.territory.of.origin 
* Whereabouts.unknown 

## Reason for resettlement if any

* Child.or.adolescent 
* Family.reunification 
* Legal.physical.protection.needs 
* Medical.needs 
* Refugee.without.local.integration.prospects 
* Survivor.of.violence.and.torture 
* Woman.at.risk 

# Exploratory Analysis

## Household characteristics

```{r, echo=FALSE}

## Cross tabulation - % - between age cohort of head of Household and average age cohort of household

kable(prop.table(table(data$agecohort, data$AVGAgecohort, useNA = "ifany"),1)*100, digits = 1,
caption = "Cross tabulation - % - between age cohort of head of Household and average age cohort of household")

## Cross tabulation - % - between average age and standard deviation of age cohort of household
kable(prop.table(table(data$AVGAgecohort, data$STDEVAgeclass, useNA = "ifany"),1)*100, digits = 1,
      caption = "Cross Tabulation: Proportion of female Vs Occurence of Specific need related to Torture ")

## Cross tabulation - % - between Year and Season of arrival
kable(prop.table(table( data$YearArrivalCategory, data$season, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Year and Season of arrival")

## Cross tabulation - % - between gender and marital Status of head of Household
kable(prop.table(table(data$dem_marriagecat, data$dem_sex, useNA = "ifany"),1)*100, digits = 1,
      caption = "Cross tabulation - % - between gender and marital Status of head of Household")

## Cross tabulation - % - between Dependency and Female Ratio
kable(prop.table(table(data$female.ratio, data$dependency, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Dependency and Female Ratio")

## Cross tabulation - % - between Dependency per type
kable(prop.table(table(data$youthdependency, data$elederndependency, useNA = "ifany"),1)*100, digits = 1,
      caption = "Cross tabulation - % - between Dependency per type")

## Cross tabulation - % - between Occupation & Education
kable(prop.table(table(data$edu_highestcat, data$occupationcat, useNA = "ifany"),1)*100, digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")

## Cross tabulation - % - between Occupation & Country of Origin
kable(prop.table(table(data$occupationcat,data$CountryOriginCategory,  useNA = "ifany"),1)*100, digits = 1,
      caption = "Cross tabulation - % - between Occupation & Country of Origin")


## Cross tabulation - % - between Education & Country of Origin
kable(prop.table(table(data$edu_highestcat, data$CountryOriginCategory, useNA = "ifany"),1)*100, digits = 1,
      caption = "Cross tabulation - % - between Education & Country of Origin")

## Cross tabulation - % - between Arrival year & Country of Origin
kable(prop.table(table(data$YearArrivalCategory, data$CountryOriginCategory,  useNA="ifany"),1)*100, digits = 1,
      caption = "Cross tabulation - % - between Arrival year & Country of Origin")


```


## Specific needs Child at Risk

```{r, echo=FALSE}

kable(prop.table(table(data$female.ratio, data$Child.at.risk, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - female.ratio")



kable(prop.table(table(data$edu_highestcat, data$SGBV, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$YearArrivalCategory, data$Child.at.risk, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - Arrival year")


kable(prop.table(table(data$dem_marriagecat, data$Child.at.risk, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - Marrital status of head of household")


kable(prop.table(table(data$dem_sex, data$Child.at.risk,  useNA="ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - gender of head of household")

```


## Specific needs: Woman at risk

```{r, echo=FALSE}

# Cross tabulation - % - between age cohort of head of Household and average age cohort of household
kable(prop.table(table(data$female.ratio, data$Woman.at.risk, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$occupationcat, data$Woman.at.risk, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$edu_highestcat, data$Woman.at.risk, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$CountryAsylum, data$Woman.at.risk, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$CountryOriginCategory, data$Woman.at.risk, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$YearArrivalCategory, data$Woman.at.risk, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$dem_marriagecat, data$Woman.at.risk, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$dem_sex, data$Woman.at.risk,  useNA="ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Arrival year & Country of Origin")

```


## Specific needs: Torture

```{r, echo=FALSE}

# Cross tabulation - % - between age cohort of head of Household and average age cohort of household
kable(prop.table(table(data$female.ratio, data$Torture, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$occupationcat, data$Torture, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$edu_highestcat, data$Torture, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$CountryAsylum, data$Torture, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$CountryOriginCategory, data$Torture, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$YearArrivalCategory, data$Torture, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$dem_marriagecat, data$Torture, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$dem_sex, data$Torture,  useNA="ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Arrival year & Country of Origin")

```


## Specific needs: Specific.legal.physical.protection.needs

```{r, echo=FALSE}

# Cross tabulation - % - between age cohort of head of Household and average age cohort of household
kable(prop.table(table(data$female.ratio, data$Specific.legal.physical.protection.needs, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$occupationcat, data$Specific.legal.physical.protection.needs, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$edu_highestcat, data$Specific.legal.physical.protection.needs, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$CountryAsylum, data$Specific.legal.physical.protection.needs, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$CountryOriginCategory, data$Specific.legal.physical.protection.needs, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$YearArrivalCategory, data$Specific.legal.physical.protection.needs, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$dem_marriagecat, data$Specific.legal.physical.protection.needs, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$dem_sex, data$Specific.legal.physical.protection.needs,  useNA="ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Arrival year & Country of Origin")


```

## Specific needs: SGBV

```{r, echo=FALSE}

# Cross tabulation - % - between age cohort of head of Household and average age cohort of household
kable(prop.table(table(data$female.ratio, data$SGBV, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$occupationcat, data$SGBV, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$edu_highestcat, data$SGBV, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$CountryAsylum, data$SGBV, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$CountryOriginCategory, data$SGBV, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$YearArrivalCategory, data$SGBV, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$dem_marriagecat, data$SGBV, useNA = "ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Occupation & Education")


kable(prop.table(table(data$dem_sex, data$SGBV,  useNA="ifany"),1)*100,digits = 1,
      caption = "Cross tabulation - % - between Arrival year & Country of Origin")

```


# Multivariate Analysis


## Multiple Correspondance analysis
```{r, echo=FALSE}
data.sample <- data[sample(1:nrow(data), 2000,replace=FALSE),
                                    c("Case.size", "dem_marriagecat", "dem_sex",
                                      "dependency", "youthdependency", "elederndependency",
                                      "agecohort", "AVGAgecohort", "STDEVAgeclass",
                                      "YearArrivalCategory", "season",
                                      "CountryOriginCategory","CountryAsylum",
                                      "occupationcat", "edu_highestcat")]
# Multiple correpondance analysis
data.mca <- MCA(data.sample, graph=FALSE)

fviz_mca_ind(data.mca, col.ind = "blue") + theme_minimal()
 
fviz_mca_var(data.mca)+ theme_minimal()

## Contribution of top 10 variables
fviz_contrib(data.mca, choice = "var", axes = 1, top = 20) + theme_minimal() +  coord_flip()
fviz_contrib(data.mca, choice = "var", axes = 2, top = 20) + theme_minimal() +  coord_flip()


```

## Hierarchical Classification on Principle Components

```{r, echo=FALSE}
data.mca.hcpc <- HCPC(data.mca, nb.clust=-1, min=3, max=4, graph=FALSE, order=FALSE, consol=TRUE)


plot(data.mca.hcpc, choice="map", title="Statistical clusters - Points cloud")

plot(data.mca.hcpc, choice="tree", title="Statistical clusters - Dendrogramme")

plot(data.mca.hcpc, title="Statistical clusters")

```

## Description of statistical clusters

```{r, echo=FALSE}

kable(data.mca.hcpc$desc.var$category$`1`, digits = 1, caption = "Description of Cluster 1")

kable(data.mca.hcpc$desc.var$category$`2`, digits = 1, caption = "Description of Cluster 2")

kable(data.mca.hcpc$desc.var$category$`3`, digits = 1, caption = "Description of Cluster 3")

kable(data.mca.hcpc$desc.var$category$`4`, digits = 1, caption = "Description of Cluster 4")

```


# Regression Analysis

Logistic Regression can be used to predict certain characteristics or events linked to one household.

## Predicting Specific Needs



## Predicting Resettlement Case acceptation

## Predicting Voluntary Departure


