---
title: "Cluster Analysis for Profiling of Syrian Refugees in Egypt, Iraq, Jordan & Lebanon"
author: "UNHCR MENA Regional Protection Service - Information Management"
date: "`r Sys.Date()`"
output:
  pdf_document:
    fig_caption: yes
    number_sections: yes
    toc: yes
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("knitr")
library(FactoMineR) ## Multiple correspondance analysis and classification
library(factoextra)
library("ggplot2")
```


```{r , echo=FALSE, warning=FALSE, message=FALSE, cache=TRUE}
samplesize <- 10000

# , cache=TRUE
#getwd("D:/R-project/proGres-analysis")
## Load the pre-processed dataset (cf "code/1-recode-data.R"")
data1 <- read.csv("D:/R-project/proGres-analysis/data/progrescase-1.csv")
##Load packages
## load all packages
source("D:/R-project/proGres-analysis/code/0-packages.R")

#names(data1)

data <- data1

## Subset for Syria
data <-data[ data$CountryOrigin == "SYR", ]

## Reorder factor levels
data$dependency <-  factor(data$dependency, levels = c( "0", "(0.001,0.2]", "(0.2,0.4]", "(0.4,0.6]", "(0.6,0.8]", "(0.8,Inf]"))
data$youthdependency <-  factor(data$youthdependency, levels = c( "0", "(0.001,0.2]", "(0.2,0.4]", "(0.4,0.6]", "(0.6,0.8]", "(0.8,Inf]"))
data$elederndependency <-  factor(data$elederndependency, levels = c( "0", "(0.001,0.2]", "(0.2,0.4]", "(0.4,0.6]", "(0.6,0.8]", "(0.8,Inf]"))
data$female.ratio <-  factor(data$female.ratio, levels = c( "0", "(0.001,0.2]", "(0.2,0.4]", "(0.4,0.6]", "(0.6,0.8]", "(0.8,Inf]"))
data$STDEVAgeclass <-  factor(data$STDEVAgeclass, levels = c( "0", "(0.001,5]", "(5,10]", "(10,15]", "(15,20]", "(20,Inf]"))
data$AVGAgecohort <-  factor(data$AVGAgecohort, levels = c( "0", "(0.1,18]", "(18,25]", "(25,35]", "(35,45]","(45,59]", "(59,Inf]"))
data$season <- factor(data$season, levels = c("Spring", "Summer", "Autumn", "Winter"))
data$CountryOriginCategory <- factor(data$CountryOriginCategory, levels = c("SYR","IRQ","AFG","IRN","HORN","AFR", "MENA", "ASIA", "OTH"))
data$Montharrival <- factor(data$Montharrival, levels = c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"))
data$edu_highestcat <- factor(data$edu_highestcat, levels = c("Unknown", "Other", "Up to Grade 5", "Grade 6-8", "Grade 9-11", "Grade 12-14", "Higher Education"))
data$dem_marriagecat <- factor(data$dem_marriagecat, levels = c("Engaged", "Single", "Married", "Widowed", "Separated", "Divorced","Unknown"))
data$occupationcat <- factor(data$occupationcat, levels = c("Manager-Professional-Technician-Technician", "ServiceMarket",
                                                                            "Agricultural", "Craft-Machine", "Elementary", "Military",
                                                                            "UnknownOccup", "NoOccup", "Student"))


data.JOR <-data[data$CountryAsylum == "JOR", ]
data.LEB <-data[data$CountryAsylum == "LEB", ]
data.ARE <-data[data$CountryAsylum == "ARE", ]
data.IRQ <-data[data$CountryAsylum == "IRQ", ]



```

This study is an attempt to improve the profiling of Syrian refugees living in Egypt, Iraq, Jordan & Lebanon. The objective is to define a series of consistent profile within this population group. The study presents the results of advanced statistical techniques, caled "cluster analysis". 

***

# Introduction

## Methodology

An important challenge to understand the profile of a population is to discover how categories interact together. Refugees profiles are defined by multiple categories.  Univariate analysis does not allow to get a synthetic vision from a large set of variables that can describe a population. Because of inherent brain & cognitive limitations, it is challenging to process together more than 7 categories and to make sense out of too many graphs.

Since the 70's, Social scientist have developed advanced __exploratory__ techniques that allow to discover statistical clusters among a specific population. Cluster analysis is an exploratory data analysis tool wich aims to group a set of records in such a way that records in the same group are more similar to each other than to those in other groups. The groups of similar records are called clusters.

[Multiple Correspondence Analysis (MCA)](https://en.wikipedia.org/wiki/Multiple_correspondence_analysis) together with [Hierarchical Classification on Principle Components](http://factominer.free.fr/classical-methods/hierarchical-clustering-on-principal-components.html) allow to process nominal categorical data (as it is the case for Refugee biodata) in order to detect and represent the underlying structures in a data set. Those analysis are performed with the [R statistical language](http://www.sthda.com/english/wiki/hcpc-hierarchical-clustering-on-principal-components-hybrid-approach-2-2-unsupervised-machine-learning).

This approach implies 5 simple steps:

 *  __Dimensionnality reduction__: Reduce the numbers of dimensions to two main composite dimensions in order to represent each observation in a 2D space.
 *  __Composition of the 2 axis__: Describe the componnent of each axis
 *  __Categories Representation__: This allow to visualise how close different variables are
 *  __Clustering__: Cluster records using the underlying proximity between variables
 *  __Modalities within each group__: Describe the main variable modalities that describe the cluster.
 *  __Overview of groups__: Display the frequency of each group as well the breakdown of specific needs within each group.
 
The variable modalities in the cluster can be __interpreted__ using the following information: 

 * _Cla/Mod_ is the pourcentage of records who have that modality who in that the statistical cluster (for instance: 50.3% of the cases who have a head of family who marrital status is single also belongs to statistical cluster 1)

 * _Mod/Cla_ is the pourcentage of records in that statistical cluster who have that modality (for instance: 81.5% of the cases of statistical cluster  1 have a head of family who marrital status is single )

 * _Global_ is the global pourcentage of all records who have that modality (for instance: in all population, 51.67% of of the cases who have a head of family who marrital status is single.)

 * _p-value_ provides an idea of the significant of the difference between Mod/Cla proportation & Global. If p-value is less than 0.05, then one category is significantly linked to another categories 
 
 * _v-test_ If the v-test is positive, it means that the category is over-expressed for the category and if the v-test is negative it means that the category is under-expressed for the category.What is interesting in the v-test is only the sign of the v-test.

## Data

The __analysis is performed at the case level__. The approach described above is applied for Syrian cases living in Egypt, Jordan , Iraq & Lebanon. A sample of 10,000 cases is randomly selected for each country in order to perform the analysis below.

The variables used for the analysis are processed to limit the number of modalities (reclassification) and to ensure a sufficient number of observation in each modalitiy. The variables are the following:

Variable             | Description
---------------------|---------------------------------------
Case.size            | Size of the household - Discretisation & recategorisation of the Number of Individual in the household 
dem_marriagecat      | Recategorisation of the Marrital status of the head of Household 
dem_sex              | Sex of the head of Household
dependency           | [Dependency Ratio](https://en.wikipedia.org/wiki/Dependency_ratio) (Child + Eldern / Working)
youthdependency      | Youth Dependency Ratio (Child + Eldern / Working)
elederndependency    | Youth Dependency Ratio (Child + Eldern / Working)
agecohort            | Age of the head of Household categorised in 5 classes
AVGAgecohort         | Average age within the household categorised in 5 classes
STDEVAgeclass        | Standard Deviation of ages within the household categorised in 5 classes
female.ratio         | % of Female in the Household categorised in 5 classes 
YearArrivalCategory  | Discretisation & recategorisation of the Year of Arrival
season               | Discretisation & recategorisation of the Month of Arrival variable
cool1                | Administrative level 1 in Country of Origin- classes with 
-                    | low numbers are aggregated. Unknown adresses are recorded as 'other'. 
coal1                | Administrative level 1 in Country of Asylum- classes  
-                    | with low numbers are aggregated. Unknown adresses are recorded as 'other'.
occupationcat        | Recategorisation of the Occupation type  of the head of Household according to
-                    | [International Standard Classification of Occupations](http://www.ilo.org/public/english/bureau/stat/isco/isco08/) 
edu_highestcat       | Recategorisation of the Highest education level of the head of Household 


***

# Egypt

## Dimensionnality reduction
```{r, echo=FALSE, warning=FALSE}
data <- data.ARE
data.sample <- data[sample(1:nrow(data), samplesize,replace=FALSE),
                                    c("Case.size", "dem_marriagecat", "dem_sex","cool1","coal1",
                                      "dependency", "youthdependency", "elederndependency", "female.ratio",
                                      "agecohort", "AVGAgecohort", "STDEVAgeclass",
                                      "YearArrivalCategory", "season",
                                      "occupationcat", "edu_highestcat")]

# Multiple correspondance analysis
data.mca <- MCA(data.sample, graph=FALSE)
fviz_mca_ind(data.mca, col.ind = "blue", label="none", addEllipses = TRUE, ellipse.level = 0.95, jitter = list(what= "point")) +
  theme_minimal() +
  labs(title = "Geometric representation of Individuals in a cloud of points" )

```

## Composition of the 2 axis
```{r, echo=FALSE, warning=FALSE}
## Contribution of top 10 variables
fviz_contrib(data.mca, choice = "var", axes = 1, top = 15) + theme_minimal() +
  labs(title = "Contribution of the top 15  variables to the first axis" )  +
  coord_flip()

fviz_contrib(data.mca, choice = "var", axes = 2, top = 15) + theme_minimal() +
  labs(title = "Contribution of the top 15 variables to the second axis" )  +
  coord_flip()
```

## Categories Representation
```{r, echo=FALSE, warning=FALSE}
fviz_mca_var(data.mca, labelsize = 3, pointsize = 0, select.var = list(contrib = 15)) +
  labs(title = "Variable categories representation for the top 15 contributions" )  +
  theme_minimal()
```

## Clustering
```{r, echo=FALSE, warning=FALSE}

## Predict projection for new rows with Multiple Correspondence Analysis

#data.predict <- predict(data.mca, data)

data.mca.hcpc <- HCPC(data.mca, nb.clust=-1, min=3, max=4, graph=FALSE, order=FALSE, consol=TRUE)

kable(data.mca.hcpc$desc.var$test.chi2, digits = 4, caption = "Ordered importance of variable contributions to clusters")
# Visualize dendrogram
#fviz_dend(data.mca.hcpc, show_labels = FALSE, rect = TRUE)
#fviz_dend(data.mca.hcpc, cex = 0.5, k = 4,  color_labels_by_k = TRUE,  title="Hierarchical clustering",  horiz=TRUE, rect = TRUE)

plot(data.mca.hcpc, choice="tree", title="Hierarchical clustering",  horiz=TRUE, tree.barplot=FALSE, cex = 0.6)

plot(data.mca.hcpc, title="3D view within the cloud of point of the Statistical clusters")
plot(data.mca.hcpc, choice="map", title="Statistical clusters within the cloud of points")





# Visualize cluster
#fviz_cluster(data.mca.hcpc, ellipse.type = "convex")

```

## Modalities within each group
Only variable modalities for which critical probility is below 0.02 are used.
```{r, echo=FALSE, warning=FALSE}

kable(data.mca.hcpc$desc.var$category$`1`, digits = 2, caption = "Description of modalities contribution to Cluster 1")


kable(data.mca.hcpc$desc.var$category$`2`, digits = 2, caption = "Description of modalities contribution to Cluster 2")


kable(data.mca.hcpc$desc.var$category$`3`, digits = 2, caption = "Description of modalities contribution to Cluster 3")


kable(data.mca.hcpc$desc.var$category$`4`, digits = 2, caption = "Description of modalities contribution to Cluster 4")

```

## Overview of groups

```{r, echo=FALSE, warning=FALSE}

cluster <- data.mca.hcpc$data.clust
cluster$clust <- as.character(cluster$clust)
cluster$clust[cluster$clust==1] <- "Cluster 1"
cluster$clust[cluster$clust==2] <- "Cluster 2"
cluster$clust[cluster$clust==3] <- "Cluster 3"
cluster$clust[cluster$clust==4] <- "Cluster 4"
cluster$clust <- as.factor(cluster$clust)

#names(cluster)

ggplot(cluster, aes(x=clust)) +
      geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
               fill="#2a87c8",colour="#2a87c8") +
      #facet_wrap(~subgov, ncol=4) +
      guides(fill=FALSE) +
      ylab("Frequency") +
      scale_y_continuous(labels=scales::percent, breaks= seq(0, 1, by = 0.1))+
      xlab("") +
      coord_flip() +
      ggtitle("Percentage of case per statistical cluster within the sample")+
      theme(plot.title=element_text(face="bold", size=9),
            plot.background = element_rect(fill = "transparent",colour = NA))
```


***

# Iraq

## Dimensionnality reduction
```{r, echo=FALSE, warning=FALSE}
data <- data.IRQ
data.sample <- data[sample(1:nrow(data), samplesize,replace=FALSE),
                                    c("Case.size", "dem_marriagecat", "dem_sex","cool1","coal1",
                                      "dependency", "youthdependency", "elederndependency", "female.ratio",
                                      "agecohort", "AVGAgecohort", "STDEVAgeclass",
                                      "YearArrivalCategory", "season",
                                      "occupationcat", "edu_highestcat")]

# Multiple correspondance analysis
data.mca <- MCA(data.sample, graph=FALSE)
fviz_mca_ind(data.mca, col.ind = "blue", label="none", addEllipses = TRUE, ellipse.level = 0.95, jitter = list(what= "point")) +
  theme_minimal() +
  labs(title = "Geometric representation of Individuals in a cloud of points" )

```

## Composition of the 2 axis
```{r, echo=FALSE, warning=FALSE}
## Contribution of top 10 variables
fviz_contrib(data.mca, choice = "var", axes = 1, top = 15) + theme_minimal() +
  labs(title = "Contribution of the top 15  variables to the first axis" )  +
  coord_flip()

fviz_contrib(data.mca, choice = "var", axes = 2, top = 15) + theme_minimal() +
  labs(title = "Contribution of the top 15 variables to the second axis" )  +
  coord_flip()
```

## Categories Representation
```{r, echo=FALSE, warning=FALSE}
fviz_mca_var(data.mca, labelsize = 3, pointsize = 0, select.var = list(contrib = 15)) +
  labs(title = "Variable categories representation for the top 15 contributions" )  +
  theme_minimal()
```

## Clustering
```{r, echo=FALSE, warning=FALSE}
data.mca.hcpc <- HCPC(data.mca, nb.clust=-1, min=3, max=4, graph=FALSE, order=FALSE, consol=TRUE)

kable(data.mca.hcpc$desc.var$test.chi2, digits = 4, caption = "Ordered importance of variable contributions to clusters")
plot(data.mca.hcpc, choice="tree", title="Hierarchical clustering",  horiz=TRUE, tree.barplot=FALSE, cex = 0.6)
plot(data.mca.hcpc, title="3D view within the cloud of point of the Statistical clusters")
plot(data.mca.hcpc, choice="map", title="Statistical clusters within the cloud of points")

```

## Modalities within each group
Only variable modalities for which critical probility is below 0.02 are used.
```{r, echo=FALSE, warning=FALSE}

kable(data.mca.hcpc$desc.var$category$`1`, digits = 2, caption = "Description of modalities contribution to Cluster 1")


kable(data.mca.hcpc$desc.var$category$`2`, digits = 2, caption = "Description of modalities contribution to Cluster 2")


kable(data.mca.hcpc$desc.var$category$`3`, digits = 2, caption = "Description of modalities contribution to Cluster 3")


kable(data.mca.hcpc$desc.var$category$`4`, digits = 2, caption = "Description of modalities contribution to Cluster 4")

```

## Overview of groups

```{r, echo=FALSE, warning=FALSE}

cluster <- data.mca.hcpc$data.clust
cluster$clust <- as.character(cluster$clust)
cluster$clust[cluster$clust==1] <- "Cluster 1"
cluster$clust[cluster$clust==2] <- "Cluster 2"
cluster$clust[cluster$clust==3] <- "Cluster 3"
cluster$clust[cluster$clust==4] <- "Cluster 4"
cluster$clust <- as.factor(cluster$clust)

#names(cluster)

ggplot(cluster, aes(x=clust)) +
      geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
               fill="#2a87c8",colour="#2a87c8") +
      #facet_wrap(~subgov, ncol=4) +
      guides(fill=FALSE) +
      ylab("Frequency") +
      scale_y_continuous(labels=scales::percent, breaks= seq(0, 1, by = 0.1))+
      xlab("") +
      coord_flip() +
      ggtitle("Percentage of case per statistical cluster within the sample")+
      theme(plot.title=element_text(face="bold", size=9),
            plot.background = element_rect(fill = "transparent",colour = NA))
```


***

# Jordan

## Dimensionnality reduction
```{r, echo=FALSE, warning=FALSE}
data <- data.JOR
data.sample <- data[sample(1:nrow(data), samplesize,replace=FALSE),
                                    c("Case.size", "dem_marriagecat", "dem_sex","cool1","coal1",
                                      "dependency", "youthdependency", "elederndependency", "female.ratio",
                                      "agecohort", "AVGAgecohort", "STDEVAgeclass",
                                      "YearArrivalCategory", "season",
                                      "occupationcat", "edu_highestcat")]

# Multiple correspondance analysis
data.mca <- MCA(data.sample, graph=FALSE)
fviz_mca_ind(data.mca, col.ind = "blue", label="none", addEllipses = TRUE, ellipse.level = 0.95, jitter = list(what= "point")) +
  theme_minimal() +
  labs(title = "Geometric representation of Individuals in a cloud of points" )

```

## Composition of the 2 axis
```{r, echo=FALSE, warning=FALSE}
## Contribution of top 10 variables
fviz_contrib(data.mca, choice = "var", axes = 1, top = 15) + theme_minimal() +
  labs(title = "Contribution of the top 15  variables to the first axis" )  +
  coord_flip()

fviz_contrib(data.mca, choice = "var", axes = 2, top = 15) + theme_minimal() +
  labs(title = "Contribution of the top 15 variables to the second axis" )  +
  coord_flip()
```

## Categories Representation
```{r, echo=FALSE, warning=FALSE}
fviz_mca_var(data.mca, labelsize = 3, pointsize = 0, select.var = list(contrib = 15)) +
  labs(title = "Variable categories representation for the top 15 contributions" )  +
  theme_minimal()
```

## Clustering
```{r, echo=FALSE, warning=FALSE}
data.mca.hcpc <- HCPC(data.mca, nb.clust=-1, min=3, max=4, graph=FALSE, order=FALSE, consol=TRUE)

kable(data.mca.hcpc$desc.var$test.chi2, digits = 4, caption = "Ordered importance of variable contributions to clusters")
plot(data.mca.hcpc, choice="tree", title="Hierarchical clustering",  horiz=TRUE, tree.barplot=FALSE, cex = 0.6)
plot(data.mca.hcpc, title="3D view within the cloud of point of the Statistical clusters")
plot(data.mca.hcpc, choice="map", title="Statistical clusters within the cloud of points")

```

## Modalities within each group
Only variable modalities for which critical probility is below 0.02 are used.
```{r, echo=FALSE, warning=FALSE}

kable(data.mca.hcpc$desc.var$category$`1`, digits = 2, caption = "Description of modalities contribution to Cluster 1")


kable(data.mca.hcpc$desc.var$category$`2`, digits = 2, caption = "Description of modalities contribution to Cluster 2")


kable(data.mca.hcpc$desc.var$category$`3`, digits = 2, caption = "Description of modalities contribution to Cluster 3")


kable(data.mca.hcpc$desc.var$category$`4`, digits = 2, caption = "Description of modalities contribution to Cluster 4")

```

## Overview of groups

```{r, echo=FALSE, warning=FALSE}

cluster <- data.mca.hcpc$data.clust
cluster$clust <- as.character(cluster$clust)
cluster$clust[cluster$clust==1] <- "Cluster 1"
cluster$clust[cluster$clust==2] <- "Cluster 2"
cluster$clust[cluster$clust==3] <- "Cluster 3"
cluster$clust[cluster$clust==4] <- "Cluster 4"
cluster$clust <- as.factor(cluster$clust)

#names(cluster)

ggplot(cluster, aes(x=clust)) +
      geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
               fill="#2a87c8",colour="#2a87c8") +
      #facet_wrap(~subgov, ncol=4) +
      guides(fill=FALSE) +
      ylab("Frequency") +
      scale_y_continuous(labels=scales::percent, breaks= seq(0, 1, by = 0.1))+
      xlab("") +
      coord_flip() +
      ggtitle("Percentage of case per statistical cluster within the sample")+
      theme(plot.title=element_text(face="bold", size=9),
            plot.background = element_rect(fill = "transparent",colour = NA))
```

***

# Lebanon

## Dimensionnality reduction
```{r, echo=FALSE, warning=FALSE}
data <- data.LEB
data.sample <- data[sample(1:nrow(data), samplesize,replace=FALSE),
                                    c("Case.size", "dem_marriagecat", "dem_sex","cool1","coal1",
                                      "dependency", "youthdependency", "elederndependency", "female.ratio",
                                      "agecohort", "AVGAgecohort", "STDEVAgeclass",
                                      "YearArrivalCategory", "season",
                                      "occupationcat", "edu_highestcat")]

# Multiple correspondance analysis
data.mca <- MCA(data.sample, graph=FALSE)
fviz_mca_ind(data.mca, col.ind = "blue", label="none", addEllipses = TRUE, ellipse.level = 0.95, jitter = list(what= "point")) +
  theme_minimal() +
  labs(title = "Geometric representation of Individuals in a cloud of points" )

```

## Composition of the 2 axis
```{r, echo=FALSE, warning=FALSE}
## Contribution of top 10 variables
fviz_contrib(data.mca, choice = "var", axes = 1, top = 15) + theme_minimal() +
  labs(title = "Contribution of the top 15  variables to the first axis" )  +
  coord_flip()

fviz_contrib(data.mca, choice = "var", axes = 2, top = 15) + theme_minimal() +
  labs(title = "Contribution of the top 15 variables to the second axis" )  +
  coord_flip()
```

## Categories Representation
```{r, echo=FALSE, warning=FALSE}
fviz_mca_var(data.mca, labelsize = 3, pointsize = 0, select.var = list(contrib = 15)) +
  labs(title = "Variable categories representation for the top 15 contributions" )  +
  theme_minimal()
```

## Clustering
```{r, echo=FALSE, warning=FALSE}
data.mca.hcpc <- HCPC(data.mca, nb.clust=-1, min=3, max=4, graph=FALSE, order=FALSE, consol=TRUE)

kable(data.mca.hcpc$desc.var$test.chi2, digits = 4, caption = "Ordered importance of variable contributions to clusters")
plot(data.mca.hcpc, choice="tree", title="Hierarchical clustering",  horiz=TRUE, tree.barplot=FALSE, cex = 0.6)
plot(data.mca.hcpc, title="3D view within the cloud of point of the Statistical clusters")
plot(data.mca.hcpc, choice="map", title="Statistical clusters within the cloud of points")

```

## Modalities within each group
Only variable modalities for which critical probility is below 0.02 are used.
```{r, echo=FALSE, warning=FALSE}

kable(data.mca.hcpc$desc.var$category$`1`, digits = 2, caption = "Description of modalities contribution to Cluster 1")


kable(data.mca.hcpc$desc.var$category$`2`, digits = 2, caption = "Description of modalities contribution to Cluster 2")


kable(data.mca.hcpc$desc.var$category$`3`, digits = 2, caption = "Description of modalities contribution to Cluster 3")


kable(data.mca.hcpc$desc.var$category$`4`, digits = 2, caption = "Description of modalities contribution to Cluster 4")

```

## Overview of groups

```{r, echo=FALSE, warning=FALSE}

cluster <- data.mca.hcpc$data.clust
cluster$clust <- as.character(cluster$clust)
cluster$clust[cluster$clust==1] <- "Cluster 1"
cluster$clust[cluster$clust==2] <- "Cluster 2"
cluster$clust[cluster$clust==3] <- "Cluster 3"
cluster$clust[cluster$clust==4] <- "Cluster 4"
cluster$clust <- as.factor(cluster$clust)

#names(cluster)

ggplot(cluster, aes(x=clust)) +
      geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
               fill="#2a87c8",colour="#2a87c8") +
      #facet_wrap(~subgov, ncol=4) +
      guides(fill=FALSE) +
      ylab("Frequency") +
      scale_y_continuous(labels=scales::percent, breaks= seq(0, 1, by = 0.1))+
      xlab("") +
      coord_flip() +
      ggtitle("Percentage of case per statistical cluster within the sample")+
      theme(plot.title=element_text(face="bold", size=9),
            plot.background = element_rect(fill = "transparent",colour = NA))
```


***

# Annex: Description of the dataset

The information recorded in the Refugee Registration Database covers not only basic demographic characteristics but also identification of Specific Needs and recording of Events such as Ressettlement Acceptation or Voluntary Departure. UNHCR Registration system is described in the [Handbook for Registration](http://www.unhcr.org/4a278ea1d.pdf) and particularly in the [annex 7](https://drive.google.com/file/d/0BzY6xxaS0lO3TXYwaUpzWi1zTW8/view) that displays the Standard Categories and Codes.

## Case Level Information

The first dataset correspond to the analysis of all cases (i.e. group of individuals registered together that often corresponds to a family unit or household) whose status is **active** within the database. Some of the indivdual information is kept for the head of household.

## Household Level Information

Variable          | Description
------------------|---------------------------------------
Num_Inds          | Number of Individual in the household
Case.size         | Size of the household - Discretisation & recategorisation of the *Num_Inds* variable
Child_0_14        | Number of Child under 14 in the household
Youth_15_17       | Number of Youth between 15 & 17 years old in the household
Work_15_64        | Number of Working age Individual (15-) in the household
Eldern_65         | Number of Working age Individual (15-) in the household
dependency        | [Dependency Ratio](https://en.wikipedia.org/wiki/Dependency_ratio) (Child + Eldern / Working)
youthdependency   | Youth Dependency Ratio (Child + Eldern / Working)
elederndependency | Youth Dependency Ratio (Child + Eldern / Working)
Male              | Number of Male in the Household
Female            | Number of Female in the Household
female.ratio      | % of Female in the Household categorised in 5 classes 
AVG_Age           | Average age within the household
AVGAgecohort      | Average age within the household categorised in 5 classes
STDEV_Age         | Standard Deviation of ages within the household
STDEVAgeclass     | Standard Deviation of ages within the household categorised in 5 classes


## Information related to the head of household

Variable          | Description
------------------|---------------------------------------
dem_age           | Age of the Head
agecohort         | Age of the head of Household categorised in 5 classes
dem_sex           | Sex of the head of Household
dem_marriage      | Marrital status of the head of Household.
dem_marriagecat   | Recategorisation of the *dem_marriage* variable
dem_birth_country | Birth Country of the head of Household. 
occupation        | Occupation type  of the head of Household according to
-                 | [International Standard Classification of Occupations](http://www.ilo.org/public/english/bureau/stat/isco/isco08/) 
occupationcat     | Recategorisation of the *occupation* variable
edu_highest       | Highest edcuation level of the head of Household 
edu_highestcat    | Recategorisation of the *edu_highest* variable

## Geographic Information

Variable                 | Description
-------------------------|---------------------------------------
CountryOrigin            | Three letters code for Country of Origin.
CountryOriginCategory    | Recategorised Country of origin - classes with 
-                        | low numbers are aggregated.
cool1                    | Administrative level 1 in Country of Origin- classes with 
-                        | low numbers are aggregated. Unknown adresses are recorded as 'other'. 
CountryAsylum            | Three letters code for Country of Asylum.
coal1                    | Administrative level 1 in Country of Asylum- classes  
-                        | with low numbers are aggregated. Unknown adresses are recorded as 'other'. 

## Chronologic Information

Variable             | Description
---------------------|---------------------------------------
YearArrival          | Year of Arrival
YearArrivalCategory  | Discretisation & recategorisation of the *Year of Arrival* variable
Montharrival         | Month of Arrival
season               | Discretisation & recategorisation of the *Month of Arrival* variable


***
